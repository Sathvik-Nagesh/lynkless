<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lynkless - Local File Share</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0a0a0a;
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem;
        }

        .container {
            max-width: 800px;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .title {
            font-size: 2.5rem;
            font-weight: 300;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #888;
            font-size: 1rem;
            font-weight: 300;
        }

        .tabs {
            display: flex;
            background: #111;
            border-radius: 12px;
            padding: 0.5rem;
            margin-bottom: 2rem;
        }

        .tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s ease;
            color: #888;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab:hover:not(.active) {
            background: #1a1a1a;
            color: #ccc;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .upload-zone {
            border: 2px dashed #333;
            border-radius: 12px;
            padding: 3rem 2rem;
            text-align: center;
            background: #111;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 2rem;
        }

        .upload-zone:hover,
        .upload-zone.dragover {
            border-color: #667eea;
            background: #1a1a1a;
            transform: translateY(-2px);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #667eea;
        }

        .upload-text {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: #ccc;
        }

        .upload-hint {
            color: #666;
            font-size: 0.9rem;
        }

        .file-list {
            background: #111;
            border-radius: 12px;
            padding: 1.5rem;
            min-height: 100px;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background: #1a1a1a;
            border-radius: 8px;
            margin-bottom: 1rem;
            transition: all 0.2s ease;
        }

        .file-item:hover {
            background: #222;
            transform: translateX(4px);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .file-icon {
            font-size: 1.5rem;
            color: #667eea;
        }

        .file-details h4 {
            color: #fff;
            margin-bottom: 0.25rem;
        }

        .file-size {
            color: #888;
            font-size: 0.9rem;
        }

        .file-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
        }

        .download-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .share-btn {
            background: #28a745;
            color: white;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .empty-state {
            text-align: center;
            color: #666;
            padding: 2rem;
        }

        .empty-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #444;
        }

        .peer-section {
            background: #111;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .peer-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .peer-input {
            flex: 1;
            min-width: 200px;
            padding: 0.75rem;
            border: 1px solid #333;
            border-radius: 6px;
            background: #1a1a1a;
            color: white;
            font-size: 0.9rem;
        }

        .peer-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .connect-btn {
            background: #667eea;
            color: white;
            padding: 0.75rem 1.5rem;
        }

        .disconnect-btn {
            background: #dc3545;
            color: white;
            padding: 0.75rem 1.5rem;
        }

        .peer-list {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 1rem;
        }

        .peer-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem;
            border-bottom: 1px solid #333;
        }

        .peer-item:last-child {
            border-bottom: none;
        }

        .peer-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .peer-status {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #28a745;
        }

        .peer-status.disconnected {
            background: #dc3545;
        }

        .invitation {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #667eea;
        }

        .invitation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .invitation-actions {
            display: flex;
            gap: 0.5rem;
        }

        .accept-btn {
            background: #28a745;
            color: white;
            padding: 0.5rem 1rem;
        }

        .deny-btn {
            background: #dc3545;
            color: white;
            padding: 0.5rem 1rem;
        }

        .status-message {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            text-align: center;
        }

        .status-success {
            background: #1e3a2e;
            color: #28a745;
            border: 1px solid #28a745;
        }

        .status-error {
            background: #3a1e1e;
            color: #dc3545;
            border: 1px solid #dc3545;
        }

        .status-info {
            background: #1e2e3a;
            color: #667eea;
            border: 1px solid #667eea;
        }

        @media (max-width: 768px) {
            .title {
                font-size: 2rem;
            }
            
            .upload-zone {
                padding: 2rem 1rem;
            }
            
            .file-item {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .peer-controls {
                flex-direction: column;
            }

            .peer-input {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Lynkless</h1>
            <p class="subtitle">Local file sharing without servers or links</p>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="files">üìÅ Files</div>
            <div class="tab" data-tab="peers">üë• Peers</div>
        </div>

        <!-- Files Tab -->
        <div class="tab-content active" id="files-tab">
            <div class="upload-zone" id="uploadZone">
                <div class="upload-icon">üìÅ</div>
                <div class="upload-text">Drop files here</div>
                <div class="upload-hint">or click to select files</div>
            </div>

            <div class="file-list" id="fileList">
                <div class="empty-state">
                    <div class="empty-icon">üì§</div>
                    <div>No files uploaded yet</div>
                </div>
            </div>
        </div>

        <!-- Peers Tab -->
        <div class="tab-content" id="peers-tab">
            <div class="peer-section">
                <h3 style="margin-bottom: 1rem; color: #ccc;">Network Connection</h3>
                
                <div class="peer-controls">
                    <input type="text" class="peer-input" id="peerId" placeholder="Enter peer ID to connect...">
                    <button class="btn connect-btn" id="connectBtn">Connect</button>
                    <button class="btn disconnect-btn" id="disconnectBtn" style="display: none;">Disconnect</button>
                </div>

                <div id="statusMessage"></div>

                <div class="peer-list" id="peerList">
                    <div class="empty-state">
                        <div class="empty-icon">üë•</div>
                        <div>No peers connected</div>
                    </div>
                </div>
            </div>

            <div class="peer-section">
                <h3 style="margin-bottom: 1rem; color: #ccc;">Your Connection ID</h3>
                <div style="background: #1a1a1a; padding: 1rem; border-radius: 8px; font-family: monospace; color: #667eea;">
                    <span id="myPeerId">Generating...</span>
                    <button class="btn" onclick="copyPeerId()" style="margin-left: 1rem; background: #333; color: white;">Copy</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        class Lynkless {
            constructor() {
                this.uploadZone = document.getElementById('uploadZone');
                this.fileList = document.getElementById('fileList');
                this.files = [];
                this.peers = new Map();
                this.myPeerId = null;
                this.connections = new Map();
                
                this.initializeEventListeners();
                this.initializeTabs();
                this.initializePeerConnection();
            }

            initializeEventListeners() {
                // Drag and drop events
                this.uploadZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    this.uploadZone.classList.add('dragover');
                });

                this.uploadZone.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    this.uploadZone.classList.remove('dragover');
                });

                this.uploadZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    this.uploadZone.classList.remove('dragover');
                    const files = Array.from(e.dataTransfer.files);
                    this.handleFiles(files);
                });

                // Click to select files
                this.uploadZone.addEventListener('click', () => {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.multiple = true;
                    input.addEventListener('change', (e) => {
                        const files = Array.from(e.target.files);
                        this.handleFiles(files);
                    });
                    input.click();
                });

                // Peer connection events
                document.getElementById('connectBtn').addEventListener('click', () => {
                    const peerId = document.getElementById('peerId').value.trim();
                    if (peerId) {
                        this.connectToPeer(peerId);
                    }
                });

                document.getElementById('disconnectBtn').addEventListener('click', () => {
                    this.disconnectFromPeers();
                });
            }

            initializeTabs() {
                const tabs = document.querySelectorAll('.tab');
                const tabContents = document.querySelectorAll('.tab-content');

                tabs.forEach(tab => {
                    tab.addEventListener('click', () => {
                        const targetTab = tab.dataset.tab;
                        
                        // Update active tab
                        tabs.forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        
                        // Update active content
                        tabContents.forEach(content => {
                            content.classList.remove('active');
                            if (content.id === `${targetTab}-tab`) {
                                content.classList.add('active');
                            }
                        });
                    });
                });
            }

            async initializePeerConnection() {
                try {
                    // Generate a random peer ID
                    this.myPeerId = 'lynkless-' + Math.random().toString(36).substr(2, 9);
                    document.getElementById('myPeerId').textContent = this.myPeerId;
                    
                    this.showStatus('Ready to connect with peers on the same network', 'info');
                } catch (error) {
                    this.showStatus('Failed to initialize peer connection: ' + error.message, 'error');
                }
            }

            async connectToPeer(peerId) {
                try {
                    this.showStatus(`Attempting to connect to ${peerId}...`, 'info');
                    
                    // Simulate connection (in real implementation, this would use WebRTC)
                    setTimeout(() => {
                        if (Math.random() > 0.3) { // 70% success rate for demo
                            this.addPeer(peerId, 'connected');
                            this.showStatus(`Successfully connected to ${peerId}`, 'success');
                            document.getElementById('connectBtn').style.display = 'none';
                            document.getElementById('disconnectBtn').style.display = 'inline-block';
                        } else {
                            this.showStatus(`Failed to connect to ${peerId}`, 'error');
                        }
                    }, 1000);
                    
                } catch (error) {
                    this.showStatus('Connection failed: ' + error.message, 'error');
                }
            }

            addPeer(peerId, status = 'connected') {
                this.peers.set(peerId, { id: peerId, status });
                this.updatePeerList();
            }

            removePeer(peerId) {
                this.peers.delete(peerId);
                this.updatePeerList();
            }

            updatePeerList() {
                const peerList = document.getElementById('peerList');
                
                if (this.peers.size === 0) {
                    peerList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">üë•</div>
                            <div>No peers connected</div>
                        </div>
                    `;
                    return;
                }

                peerList.innerHTML = '';
                this.peers.forEach(peer => {
                    const peerItem = document.createElement('div');
                    peerItem.className = 'peer-item';
                    peerItem.innerHTML = `
                        <div class="peer-info">
                            <div class="peer-status ${peer.status === 'connected' ? '' : 'disconnected'}"></div>
                            <span>${peer.id}</span>
                        </div>
                        <div class="peer-actions">
                            <button class="btn" onclick="lynklessApp.shareFilesWithPeer('${peer.id}')" 
                                    style="background: #667eea; color: white;">Share Files</button>
                        </div>
                    `;
                    peerList.appendChild(peerItem);
                });
            }

            disconnectFromPeers() {
                this.peers.clear();
                this.updatePeerList();
                this.showStatus('Disconnected from all peers', 'info');
                document.getElementById('connectBtn').style.display = 'inline-block';
                document.getElementById('disconnectBtn').style.display = 'none';
            }

            shareFilesWithPeer(peerId) {
                if (this.files.length === 0) {
                    this.showStatus('No files to share', 'error');
                    return;
                }
                
                this.showStatus(`Sharing ${this.files.length} files with ${peerId}...`, 'info');
                
                // Simulate file sharing (in real implementation, this would send files via WebRTC)
                setTimeout(() => {
                    this.showStatus(`Successfully shared files with ${peerId}`, 'success');
                }, 2000);
            }

            showStatus(message, type) {
                const statusDiv = document.getElementById('statusMessage');
                statusDiv.innerHTML = `<div class="status-message status-${type}">${message}</div>`;
                
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 5000);
            }

            handleFiles(files) {
                files.forEach(file => {
                    if (!this.files.find(f => f.name === file.name && f.size === file.size)) {
                        this.files.push(file);
                        this.addFileToList(file);
                    }
                });
                this.updateEmptyState();
            }

            addFileToList(file) {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                const fileIcon = this.getFileIcon(file.type);
                const fileSize = this.formatFileSize(file.size);
                
                fileItem.innerHTML = `
                    <div class="file-info">
                        <div class="file-icon">${fileIcon}</div>
                        <div class="file-details">
                            <h4>${file.name}</h4>
                            <div class="file-size">${fileSize}</div>
                        </div>
                    </div>
                    <div class="file-actions">
                        <a href="#" class="btn download-btn" download="${file.name}">Download</a>
                        <button class="btn share-btn" onclick="lynklessApp.shareFile('${file.name}')">Share</button>
                    </div>
                `;

                // Create blob URL for download
                const downloadBtn = fileItem.querySelector('.download-btn');
                downloadBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const blob = new Blob([file], { type: file.type });
                    const url = URL.createObjectURL(blob);
                    downloadBtn.href = url;
                    
                    // Clean up blob URL after download
                    setTimeout(() => {
                        URL.revokeObjectURL(url);
                    }, 1000);
                });

                this.fileList.appendChild(fileItem);
            }

            shareFile(fileName) {
                if (this.peers.size === 0) {
                    this.showStatus('No peers connected to share with', 'error');
                    return;
                }
                
                this.showStatus(`Sharing ${fileName} with connected peers...`, 'info');
                
                // Simulate file sharing
                setTimeout(() => {
                    this.showStatus(`Successfully shared ${fileName}`, 'success');
                }, 1500);
            }

            getFileIcon(mimeType) {
                if (mimeType.startsWith('image/')) return 'üñºÔ∏è';
                if (mimeType.startsWith('video/')) return 'üé•';
                if (mimeType.startsWith('audio/')) return 'üéµ';
                if (mimeType.startsWith('text/')) return 'üìÑ';
                if (mimeType.includes('pdf')) return 'üìï';
                if (mimeType.includes('zip') || mimeType.includes('rar')) return 'üì¶';
                return 'üìÅ';
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            updateEmptyState() {
                const emptyState = this.fileList.querySelector('.empty-state');
                if (this.files.length > 0 && emptyState) {
                    emptyState.remove();
                } else if (this.files.length === 0 && !emptyState) {
                    this.fileList.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-icon">üì§</div>
                            <div>No files uploaded yet</div>
                        </div>
                    `;
                }
            }
        }

        // Global functions
        function copyPeerId() {
            const peerId = document.getElementById('myPeerId').textContent;
            navigator.clipboard.writeText(peerId).then(() => {
                // Show temporary success message
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                btn.style.background = '#28a745';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#333';
                }, 2000);
            });
        }

        // Initialize the app
        let lynklessApp;
        document.addEventListener('DOMContentLoaded', () => {
            lynklessApp = new Lynkless();
        });
    </script>
</body>
</html>

